# 内存模型

**目录：**
1. [内存模型](#mem)
   1. [作用域](#scope)
   2. [连接性](#linkage)
   3. [存储持续性](#continuable)
2. 名称空间

--------------

<a id="mem"></a>
## 1. 内存模型
不同的C++存储方式使用过**存储持续性**、**作用域**和**链接性**来描述的。

<a id="scope"></a>
### 1.1 作用域 
**作用域**（scope）描述了名称在文件的多大范围可见。  
> 在名字空间中声明的变量的作用域为整个名称空间，因此全局作用域是名称空间作用域的特例。


<a id="linkage"></a>
### 1.2 链接性 
**链接性**（linkage）描述了名称如何在不同单元间共享。链接为**外部**的名称可以在文件间共享，链接性为**内部**的名称只能由一个文件中的函数共享。自动变量的名称是没有链接性，因为他们不能共享。  

#### 1.2.1 关键字static
`static`意思为静态，在文件中（非函数内）变量定义前加上static表示该变量链接性为内部，只能在本文件共享。
```C++
static int price = 10;     //链接性为文件内部
int num = 10;             //链接性为外部

int main()
{
...
}
```

#### 1.2.1 关键字extern
如果要在多个文件种使用外部变量，只需要在一个文件中包含该变量的定义，但使用该变量的其他文件中，都必须使用关键字`extern`声明它：  
```C++
// file1.cpp
int dogs = 22;          //外部变量定义
extern int cats = 10;   //同外部变量定义
```

```C++
// file2.cpp
extern int dogs;        //dogs为file1.cpp中定义的变量，两个变量的地址是一样的
extern int cats;        //同上   

void FeedAnimal()
{
 int total = dogs + cat;
 cout<<total<<" animals feed"<<endl;
}
```


<a id="continuable"></a>
### 1.3 存储持续性
**存储持续性**表示数据保存在内存中的时间长度。C++11中有四种不同存储持续性：
- 自动存储持续性
- 静态存储持续性
- 线程存储持续性
- 动态存储持续性  

|    存储描述     | 持续性  |  作用域   |链接性   | 如何声明 |  
| :----          |:----:   | :-----:  | :-----: | :-----: | 
|自动            | 自动     | 代码块   |   无    | 在代码块中|  
|寄存器          | 自动     | 代码块   |   无    | 在代码块中，使用关键字**register**|  
|静态，无链接性   | 静态     | 代码块   |   无    | 在代码块中，使用关键字**static** |  
|静态，外部链接性 | 静态     |  文件    |   外部  | 不在任何函数内|  
|静态，内部链接性 | 静态     |  文件    |   内部  | 不在任何函数内，使用关键字**static** | 
#### 1.3.1 自动存储持续性
默认情况下，在函数中声明的函数参数和变量的存储持续性为自动，作用域为局部（代码块内），没有链接性。带函数运行结束后，自动释放相关内存。
``` C++
void main()
{
   int num =0;
   std::cout<< &num<<"\n";
   {
      int num = 0;
      std::cout<<&num<<std::endl;
   }
   //两个相同的num变量其地址输出不一样
}

```
**auto**、**register**关键字可以表示声明自动变量，不过这两个关键字不太常用现在。
